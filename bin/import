#!/usr/bin/env php
<?php

require __DIR__.'/../vendor/autoload.php';

use AA\FeedImporter\Infrastructure\Service\LocalResource;
use AA\FeedImporter\Infrastructure\Service\CSVFeedReader;
use AA\FeedImporter\Infrastructure\Service\VideoProvider;
use AA\FeedImporter\Infrastructure\Persistence\Cassandra\VideoRepository;

use AA\FeedImporter\Application\UseCase\ImportVideos;

// Validate to input the provider name 
if(!isset($argv[1])){
        echo "You must pass the feed provider";
        die();
}

//todo: DI services with provider names
$resource = new LocalResource(__DIR__."/../feed-exports/{$argv[1]}.csv");
$feedReader = new CSVFeedReader($resource);

$useCase = new ImportVideos(new VideoProvider($feedReader), new VideoRepository());
$useCase->execute();
